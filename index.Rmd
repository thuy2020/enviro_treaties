---
title: "Multilateral Evironmental Agreements 1857 - 2016"
output: 
  flexdashboard::flex_dashboard:
    css: custom.css
    orientation: columns
    vertical_layout: fill
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(rio)
library(tidyverse)
library(ggplot2)
library(gghighlight)
library(colorblindr)
library(rnaturalearth)
library(gt)
library(reactable)
library(gganimate)
library(patchwork)
library(ggridges)
library(flexdashboard)
library(plotly)
library(lubridate)
```

Data  {data-icon="fa-table"}
=======================================

Column {data-width=550}
-----------------------------------------------------------------------

### Original Data from Ronald B. Mitchell. 2002-2020. \n International Environmental Agreements Database Project (Version 2020.1). Available at: http://iea.uoregon.edu/

```{r echo = FALSE}
data <- import(here::here("data", "iea_measonly.dta"))
reactable(data, 
          defaultSortOrder = "desc",
          filterable = TRUE, minRows = 10)
```

Column {data-width=450}
-----------------------------------------------------------------------

### Data used for visualization


```{r echo = FALSE}
d <- data %>%
  select(mitch_id, tsig_yr, teif_yr, subject_category, lineage)


reactable(d, 
          defaultSortOrder = "desc",
          filterable = TRUE, minRows = 10,
          columns = list(
  mitch_id = colDef("ID"),
  tsig_yr = colDef("Year signed"),
  teif_yr = colDef("Year ratified"),
  subject_category = colDef("Subject"),
  lineage = colDef("Lineage")
))

```


### Agreements were ratified in the same year they were signed 

```{r echo = FALSE}
sameyear = function(...) return(349)
ratifysameyear = sameyear()
valueBox(ratifysameyear, icon = "fa-clock-o") # change color 

```

### Agreements never got ratified 

```{r echo = FALSE}
never = function(...) return(141)
neverratify = never()
valueBox(neverratify, icon = "fa-ban")

```


### Years taken, on average, from signature to ratification 

```{r echo = FALSE}
meanyear = function(...) return(2.2)
gapyear = meanyear()
valueBox(gapyear, icon = "fa-pause")

```

Concept-final {data-icon="fa-book"}
=======================================

What We Know (and Could Know) About International Environmental Agreements
(Authors: Ronald B. Mitchell, Liliana B. Andonova, Mark Axelrod, Jörg Balsiger, Thomas Bernauer, Jessica F. Green, James Hollway, Rakhyun E. Kim, and Jean-Frédéric Mori
Source: Global Environmental Politics 20:1, February 2020, https://doi.org/10.1162/glep_a_00544)

Column {data-width=600}
-----------------------------------------------------------------------

### Change in number of agreements 1857 - 2016

```{r echo = FALSE}
total <- d %>% 
  select(tsig_yr, subject_category) %>% 
  group_by(tsig_yr) %>%
  add_count()  %>% 
  mutate(date = mdy(paste0("01-01-", tsig_yr)))

pollution <- d %>% 
  select(subject_category, tsig_yr) %>% 
  filter(subject_category == "Pollution") %>% 
  group_by(tsig_yr) %>% 
  add_count() %>% 
  mutate(date = mdy(paste0("01-01-", tsig_yr))) 

species <- d %>% 
  select(subject_category, tsig_yr) %>% 
  filter(subject_category == "Species") %>% 
  group_by(tsig_yr) %>% 
  add_count() %>% 
  mutate(date = mdy(paste0("01-01-", tsig_yr))) 


threelines <- bind_rows(total, pollution, species, .id = "dataset") %>% 
  mutate(dataset = ifelse(dataset == "1", "Total", dataset)) %>% 
  mutate(dataset = ifelse(dataset == "2", "Pollution", dataset)) %>% 
  mutate(dataset = ifelse(dataset == "3", "Species", dataset)) 


event1 <- tibble(date = lubridate::mdy(c("December 31, 1972")),
                text = c("UN Human \n Environment"))

event2 <- tibble(date = lubridate::mdy(c("December 31, 1992")),
                text = c("UN Environment \n and Development"))

 change_number <- threelines %>% 
  group_by(tsig_yr, dataset) %>%
  add_count()  %>% 
  mutate(date = mdy(paste0("01-01-", tsig_yr))) %>% 
  ggplot(aes(date, n)) +
  geom_line(aes(color = dataset)) +
  geom_vline(aes(xintercept = date), 
             data = event1,
             color = "#C55644",
             lty = "dashed") +
  geom_text(aes(x = date, y = 45, label = text),
            data = event1,
            color = "black",
            nudge_x = 2) +
  geom_vline(aes(xintercept = date), 
             data = event2,
             color = "#C55644",
             lty = "dashed") +
  geom_text(aes(x = date, y = 35, label = text),
            data = event2,
            color = "black",
            nudge_x = 2) + 
  scale_y_continuous(expand = c(0, 0)) +
  labs(
    x = "",
    y = "Number of Agreements Signed",
    title = "Multilateral Environmental Agreements Signed \n 1857 - 2016",
    caption = "Data from Ronald B. Mitchell. 2002-2020 \n International Environmental Agreements Database Project (Version 2020.1). \n http://iea.uoregon.edu/ ",
    color = "Agreement \n category"
  ) +
  scale_color_OkabeIto() +
  theme_minimal() +
  theme(legend.position = c(.3, .7))
change_number

tempt <- threelines %>% 
  select(date, subject_category, n)

# ggplotly(change_number) using this will lose control over the legend position and the vline :(

```


Column {data-width=350}
-----------------------------------------------------------------------

### Consent to be bound

```{r echo = FALSE}
gauge(448, min = 0, max = 1311, gaugeSectors(
  success = c(41, 50), warning = c(21, 40), danger = c(0, 20)
))
```

### Regular update needed 

```{r echo = FALSE}
gauge(264, min = 0, max = 1311, gaugeSectors(
  success = c(80, 100), warning = c(40, 79), danger = c(0, 39)
))
```

### Abtract

Initiated in 2002, the International Environmental Agreements Data Base (IEADB) cata- logs the texts, memberships, and design features of over 3,000 multilateral and bilateral environmental agreements. Using IEADB data, we create a comprehensive review of the evolution of international environmental law, including how the number, subjects, and state memberships in IEAs have changed over time. By providing IEA texts, the IEADB helps scholars identify and systematically code IEA design features. We review scholar- ship derived from the IEADB on international environmental governance, including insights into IEA membership, formation, and design as well as the deeper structure of international environmental law. We note the IEADB’s value as a teaching tool to pro- mote undergraduate and graduate teaching and research. The IEADB’s structure and con- tent opens up both broad research realms and specific research questions, and facilitates the ability of scholars to use the IEADB to answer those questions of greatest interest to them.

Source: What We Know (and Could Know) About International Environmental Agreements
Authors: Ronald B. Mitchell, Liliana B. Andonova, Mark Axelrod, Jörg Balsiger, Thomas Bernauer, Jessica F. Green, James Hollway, Rakhyun E. Kim, and Jean-Frédéric Mori
Source: Global Environmental Politics 20:1, February 2020, https://doi.org/10.1162/glep_a_00544)

Concept-draft {data-icon="fa-book"}
=======================================

What We Know (and Could Know) About International Environmental Agreements
(Authors: Ronald B. Mitchell, Liliana B. Andonova, Mark Axelrod, Jörg Balsiger, Thomas Bernauer, Jessica F. Green, James Hollway, Rakhyun E. Kim, and Jean-Frédéric Mori
Source: Global Environmental Politics 20:1, February 2020, https://doi.org/10.1162/glep_a_00544)

Column {data-width=600}
-----------------------------------------------------------------------

### Change in number of agreements 1857 - 2016

```{r echo = FALSE}
total <- d %>% 
  select(tsig_yr, subject_category) %>% 
  group_by(tsig_yr) %>%
  add_count()  %>% 
  mutate(date = mdy(paste0("01-01-", tsig_yr)))

pollution <- d %>% 
  select(subject_category, tsig_yr) %>% 
  filter(subject_category == "Pollution") %>% 
  group_by(tsig_yr) %>% 
  add_count() %>% 
  mutate(date = mdy(paste0("01-01-", tsig_yr))) 

species <- d %>% 
  select(subject_category, tsig_yr) %>% 
  filter(subject_category == "Species") %>% 
  group_by(tsig_yr) %>% 
  add_count() %>% 
  mutate(date = mdy(paste0("01-01-", tsig_yr))) 


threelines <- bind_rows(total, pollution, species, .id = "dataset") %>% 
  mutate(dataset = ifelse(dataset == "1", "Total", dataset)) %>% 
  mutate(dataset = ifelse(dataset == "2", "Pollution", dataset)) %>% 
  mutate(dataset = ifelse(dataset == "3", "Species", dataset)) 


event1 <- tibble(date = lubridate::mdy(c("December 31, 1972")),
                text = c("UN Human \n Environment"))

event2 <- tibble(date = lubridate::mdy(c("December 31, 1992")),
                text = c("UN Environment \n and Development"))

 change_number <- threelines %>% 
  group_by(tsig_yr, dataset) %>%
  add_count()  %>% 
  mutate(date = mdy(paste0("01-01-", tsig_yr))) %>% 
  ggplot(aes(date, n)) +
  geom_line(aes(color = dataset)) +
  geom_vline(aes(xintercept = date), 
             data = event1,
             color = "#C55644",
             lty = "dashed") +
  geom_text(aes(x = date, y = 45, label = text),
            data = event1,
            color = "black",
            nudge_x = 2) +
  geom_vline(aes(xintercept = date), 
             data = event2,
             color = "#C55644",
             lty = "dashed") +
  geom_text(aes(x = date, y = 35, label = text),
            data = event2,
            color = "black",
            nudge_x = 2) + 
  scale_y_continuous(expand = c(0, 0)) +
  labs(
    x = "",
    y = "Number of Agreements Signed",
    title = "Multilateral Environmental Agreements Signed \n 1857 - 2016",
    caption = "Data from Ronald B. Mitchell. 2002-2020 \n International Environmental Agreements Database Project (Version 2020.1). \n http://iea.uoregon.edu/ ",
    color = "Agreement \n category"
  ) +
  scale_color_OkabeIto() +
  theme_minimal() +
  theme(legend.position = c(.3, .7))
change_number
# 
# ggplotly(change_number)

```


Row {.tabset .tabset-fade}
-----------------------------------------------------------------------

### Change in number: Option 2

```{r echo = FALSE}
total %>% 
  ggplot(aes(tsig_yr, n)) +
  geom_line() +
  theme_minimal() +
  labs(
    x = "",
    y = "Number of Agreements Signed",
    title = "Multilateral Environmental Agreements Signed \n 1857 - 2016",
    caption = "Data from Ronald B. Mitchell. 2002-2020 \n International Environmental Agreements Database Project (Version 2020.1). \n http://iea.uoregon.edu/ "
  )
```

> The first plot simply depicts the general change in number of agreement over time. It does not tell us more detail about what are the main environmental areas that states cooperate.

### Change in number:  Option 3 

```{r echo = FALSE}
threelines %>% 
  group_by(tsig_yr, dataset) %>%
  add_count()  %>% 
  mutate(date = mdy(paste0("01-01-", tsig_yr))) %>% 
  ggplot(aes(date, n)) +
  geom_line(aes(color = dataset)) +
  scale_y_continuous(expand = c(0, 0)) +
  labs(
    x = "",
    y = "Number of Agreements Signed",
    title = "Multilateral Environmental Agreements Signed \n 1857 - 2016",
    caption = "Data from Ronald B. Mitchell. 2002-2020 \n International Environmental Agreements Database Project (Version 2020.1). \n http://iea.uoregon.edu/ ",
    color = "Agreement \n category"
  ) +
  theme_minimal() 
  # theme(legend.position = c(.3, .7))

```

> This plot reveals that species and pollution are the two main environemtal areas that countries have been cooperating on in the last two centuries, wit pollution gaining more attention recently. However, general audience might not be able to read the timeline effectively without any guidance what happens between 1950 - 2000 that produced so many agreements. Plus, two points are not satisfying in terms of aesthetic: 1) the legend on the right takes space while there's plenty space in within the plot, and 2) the color is not attractive. All of these limitation is fixed to give the final plot in the left. 

Visualization-final {data-icon="fa-signal"}
=======================================

Column {data-width=500}
-----------------------------------------------------------------------

### Top 15 lineages collectively account for about one-third of the total Multilateral Evironmental Agreements 


```{r echo = FALSE}
lng <- data %>% 
  select(lineage, tsig_yr) %>% 
  mutate(lineage = ifelse(lineage == "", "Other", lineage)) %>%  
  mutate(lineage = ifelse(lineage == "MARPOL", "Prevention of Pollution from Ships", lineage)) %>% 
  mutate(lineage = ifelse(lineage == "LRTAP", "Long-Range Transboundary Air Pollution", lineage)) %>%
  mutate(lineage = ifelse(lineage == "CITES", "Trade in Endangered Species", lineage)) %>% 
  mutate(lineage = ifelse(lineage == "MedPlan", "Mediterranean Action Plan", lineage)) %>% 
  add_count(lineage) %>% 
  select(lineage, n) %>% 
  count(lineage) %>% 
  arrange(desc(n)) 

top15 <- lng %>%
  top_n(15, n)

bottom10 <- lng %>% 
  top_n(-10,n)
  
total_lng <- lng %>% 
summarise(total = sum(n))

top15 %>% 
  ggplot(aes(fct_reorder(lineage, n), n)) +
  geom_col(aes(fill = lineage),
           alpha = .7) +
  coord_flip() +
  scale_y_continuous(expand = c(0, 0)) +
  theme_minimal() +
  labs(
    x = "",
    y = "Number of Agreements",
    title = "Top 15 lineages",
    caption = "Data from Ronald B. Mitchell. 2002-2020. \n International Environmental Agreements Database Project (Version 2020.1)
http://iea.uoregon.edu/ "
    
  ) +
  scale_fill_viridis_d() + 
  guides(fill = FALSE)
```

> A lineages is defined as a set “of agreements, protocols, and amendments that modify, extend, replace, or explicitly derive from one or more original agreements (Mitchell 2003, 432).” 
Source: Mitchell, Ronald B. 2003. International Environmental Agreements: A Survey of Their Fea- tures, Formation, and Effects. Annual Review of Environment and Resources 28: 429–461.

Column {data-width=550}
-----------------------------------------------------------------------

### Change in type of agreements over time

```{r echo = FALSE, fig.width = 18, fig.height=10}

d_at <- data %>% 
  select(tsig_yr, agreement_type) %>% 
  group_by(tsig_yr, agreement_type) %>% 
  count() 

d_at%>% 
  ggplot(aes(tsig_yr, n, fill = agreement_type)) +
  geom_ribbon(aes(ymin = 0,
                  ymax = n,
                  fill = agreement_type,
                  color = agreement_type),
              alpha = 0.4) +
  scale_fill_brewer("agreement_type", palette = "Set2")  +
  scale_color_brewer("agreement_type", palette = "Set2") +
  facet_wrap(~agreement_type) +
   labs(
    x = "",
    y = "Number of Agreements Signed",
    title = "Multilateral Environmental Agreements by Type",
    caption = "Data from Ronald B. Mitchell. 2002-2020. \n International Environmental Agreements Database Project (Version 2020.1).
http://iea.uoregon.edu/ "
  ) +
  guides(fill = FALSE, color = FALSE) +
  theme_minimal(30) 

```


### Agreements have become increasingly diverse in the subjects address overtime \n (New agreements are highlighted in red)

```{r echo = FALSE, fig.width = 18, fig.height=10}
bf45 <- d %>% 
  filter(tsig_yr < 1945) %>% 
  group_by(subject_category) %>% 
  count(subject_category) %>% 
  ggplot(aes(fct_reorder(subject_category,n), n))+
  geom_col(fill = "cornflowerblue") +
  coord_flip() +
  scale_fill_OkabeIto() +
  theme_minimal(base_size = 30) +
  guides(fill = FALSE, color = FALSE) +
  labs(
    x = "",
    y = "",
    title = "1857 - 1944"
  )

newsubject <- d %>% 
  filter(tsig_yr > 1944) %>%
  mutate(subject_category = ifelse(subject_category == "", "Other", subject_category)) %>%
  filter(subject_category == "Ocean" | 
         subject_category == "General" |
         subject_category == "Habitat"|
         subject_category == "Other") %>% 
  group_by(subject_category) %>% 
  count(subject_category)


from45 <- d %>% 
  filter(tsig_yr > 1944) %>% 
  mutate(subject_category = ifelse(subject_category == "", "Other", subject_category)) %>%
  group_by(subject_category) %>% 
  count(subject_category) %>%
  ggplot(aes(fct_reorder(subject_category,n), n))+
  geom_col(fill = "cornflowerblue", 
           alpha = .5) +
  geom_col(data = newsubject,
           fill = "#C55644",
           alpha = .8) +
  coord_flip() +
  theme_minimal(base_size = 30) +
  guides(fill = FALSE, color = FALSE) +
  labs(
    x = "",
    y = "",
    title = "1945 - 2016",
    caption = "Data from Ronald B. Mitchell. 2002-2020. \n International Environmental Agreements Database Project (Version 2020.1).
http://iea.uoregon.edu/ "
  )

bf45 + from45
```



Visualization-draft {data-icon="fa-signal"}
=======================================

Row {.tabset .tabset-fade}
-----------------------------------------------------------------------

### Change in type of agreements over time: Option 2

```{r echo=FALSE}
d_at %>% 
 ggplot(aes(tsig_yr, agreement_type)) +
  geom_density_ridges(color = "white",
                                fill = "#A9E5C5") +
  xlim(1857,2016) +
  labs(
    x = "",
    y = "",
    title = "Environmental Agreements Signed \n by type 1857 - 2016",
    caption = "Data from Ronald B. Mitchell. 2002-2020. International Environmental Agreements Database Project (Version 2020.1).
Available at: http://iea.uoregon.edu/ Date accessed: 26 February 2020"
  ) +
  guides(fill = FALSE, color = FALSE) +
  theme_minimal(base_size = 15)  
```
> This plot gives us a general sense about types of agreement. But the truncated shapes make it somewhat ugly. 

### Change in type of agreements over time: Option 3

```{r echo=FALSE}
d_at %>% 
ggplot(aes(tsig_yr, agreement_type)) +
  geom_tile(aes(fill = n),
            color = "gray90") +
  scale_fill_viridis_c(option = "magma") +
  # coord_fixed() +     coord_fixed make the fig high too small
  theme(legend.position = "bottom", 
        legend.direction = "horizontal", 
        legend.key.size = unit(1, 'cm'),
        legend.key.height = unit(0.5,"cm")) +
  labs(
    x = "",
    y = "Type of Agreement",
    title = "Environmental Agreements Signed by Type between 1857 - 2016",
    caption = "Data from Ronald B. Mitchell. 2002-2020. International Environmental Agreements Database Project (Version 2020.1).
Available at: http://iea.uoregon.edu/ Date accessed: 26 February 2020"
  ) 
```

> Heatmap doesn't seem to be ideal to present so many points in the x axis (year in this case). If I use coord_fixed(), it becomes way too small to read. 

Row {.tabset .tabset-fade}
-------------------------------------

### Agreements have become increasingly diverse in the subjects address overtime: final

```{r echo = FALSE, fig.width = 18, fig.height=10}
bf45 <- d %>% 
  filter(tsig_yr < 1945) %>% 
  group_by(subject_category) %>% 
  count(subject_category) %>% 
  ggplot(aes(fct_reorder(subject_category,n), n))+
  geom_col(fill = "cornflowerblue") +
  coord_flip() +
  scale_fill_OkabeIto() +
  theme_minimal(base_size = 30) +
  guides(fill = FALSE, color = FALSE) +
  labs(
    x = "",
    y = "",
    title = "1857 - 1944"
  )

newsubject <- d %>% 
  filter(tsig_yr > 1944) %>%
  mutate(subject_category = ifelse(subject_category == "", "Other", subject_category)) %>%
  filter(subject_category == "Ocean" | 
         subject_category == "General" |
         subject_category == "Habitat"|
         subject_category == "Other") %>% 
  group_by(subject_category) %>% 
  count(subject_category)


from45 <- d %>% 
  filter(tsig_yr > 1944) %>% 
  mutate(subject_category = ifelse(subject_category == "", "Other", subject_category)) %>%
  group_by(subject_category) %>% 
  count(subject_category) %>%
  ggplot(aes(fct_reorder(subject_category,n), n))+
  geom_col(fill = "cornflowerblue", 
           alpha = .5) +
  geom_col(data = newsubject,
           fill = "#C55644",
           alpha = .8) +
  coord_flip() +
  theme_minimal(base_size = 30) +
  guides(fill = FALSE, color = FALSE) +
  labs(
    x = "",
    y = "",
    title = "1945 - 2016",
    caption = "Data from Ronald B. Mitchell. 2002-2020. \n International Environmental Agreements Database Project (Version 2020.1).
http://iea.uoregon.edu/ "
  )

bf45 + from45
```

> New subjects are highlighted in red


### Agreements have become increasingly diverse in the subjects address overtime: draft

```{r echo=FALSE}

bf45 <- d %>% 
  filter(tsig_yr < 1945) %>% 
group_by(subject_category) %>% 
  count(subject_category) %>% 
ggplot(aes(fct_reorder(subject_category,n), n))+
  geom_col(fill = "cornflowerblue") +
  geom_text(aes(subject_category, n, label = n),
            # nudge_y = -1,
            size = 2) +
  coord_flip() +
  guides(fill = FALSE, color = FALSE) +
  labs(
    x = "",
    y = "",
    title = "Number of Agreements by Subject \n
    Before 1945"
  )

# highlight new subjects in this period
newsubject4570 <- d %>% 
  filter(tsig_yr > 1944 &
          tsig_yr < 1972) %>%
  filter(subject_category == "Ocean" | 
         subject_category == "General" |
         subject_category == "Habitat") %>% 
  group_by(subject_category) %>% 
  count(subject_category)

bt4570 <- d %>% 
  filter(tsig_yr > 1944 &
          tsig_yr < 1972) %>% 
  group_by(subject_category) %>% 
  count(subject_category) %>% 
ggplot(aes(fct_reorder(subject_category,n), n))+
  geom_col(fill = "cornflowerblue", 
           alpha = .5) +
  geom_col(data = newsubject4570,
           fill = "#C55644") +
  scale_fill_OkabeIto() +
  geom_text(aes(subject_category, n, label = n),
            # nudge_y = -2, # hard to get the right value. 
            size = 2) +
  coord_flip() +
  guides(fill = FALSE, color = FALSE) +
  labs(
    x = "",
    y = "",
    title = "Between 1945 - 1972"
  ) 


newsubject70001 <- d %>% 
  filter(tsig_yr > 1971 &
        tsig_yr < 2000) %>% 
  filter(subject_category == "Ocean" | 
         subject_category == "General" |
         subject_category == "Habitat") %>% 
  group_by(subject_category) %>% 
  count(subject_category)

newsubject70002 <- d %>% 
  filter(tsig_yr > 1971 &
        tsig_yr < 2000) %>% 
  mutate(subject_category = ifelse(subject_category == "", "Other", subject_category)) %>%
  filter(subject_category == "Other") %>% 
  group_by(subject_category) %>% 
  count(subject_category)

bt7000 <- d %>%  
  filter(tsig_yr > 1971 &
        tsig_yr < 2000) %>% 
  mutate(subject_category = ifelse(subject_category == "", "Other", subject_category)) %>% 
  group_by(subject_category) %>% 
  count(subject_category)  %>% 
ggplot(aes(fct_reorder(subject_category,n), n))+
  geom_col(fill = "cornflowerblue",
           alpha = .5) +
  geom_col(data = newsubject70001,  
           fill = "#C55644",
           alpha = .5) +
  geom_col(data = newsubject70002,
           fill = "purple") +
  geom_text(aes(subject_category, n, label = n),
            # nudge_y = -6,
            size = 2) +
  coord_flip() +
  guides(fill = FALSE, color = FALSE) +
  labs(
    x = "",
    y = "",
    title = "Between 1972 - 2000"
  )

newsubject20001 <- d %>% 
  filter(tsig_yr > 1999) %>% 
  filter(subject_category == "Ocean" | 
         subject_category == "General" |
         subject_category == "Habitat") %>% 
  group_by(subject_category) %>% 
  count(subject_category)

newsubject20002 <- d %>% 
  filter(tsig_yr > 1999) %>% 
  mutate(subject_category = ifelse(subject_category == "", "Other", subject_category)) %>%
  filter(subject_category == "Other") %>% 
  group_by(subject_category) %>% 
  count(subject_category)



af2000 <- d %>% 
  filter(tsig_yr > 1999) %>% 
  mutate(subject_category = ifelse(subject_category == "", "Other", subject_category)) %>% 
  group_by(subject_category) %>% 
  count(subject_category) %>% 
ggplot(aes(fct_reorder(subject_category,n), n))+
  geom_col(fill = "cornflowerblue", 
           alpha = .5) +
  geom_col(data = newsubject20001,
           fill = "#C55644",
           alpha = .5) +
  geom_col(data = newsubject20002,
           fill = "purple",
           alpha = .5) +
  geom_text(aes(subject_category, n, label = n),
            # nudge_y = -1, 
            size = 2) +
  coord_flip() +
  guides(fill = FALSE, color = FALSE) +
  labs(
    x = "",
    y = "",
    title = "After 2000", 
    caption = "Data from Ronald B. Mitchell. 2002-2020. International Environmental Agreements Database Project (Version 2020.1).
Available at: http://iea.uoregon.edu/ Date accessed: 26 February 2020"
  ) 
bf45 + bt4570 + bt7000 + af2000

```

> There are several problems with this plot: 
1) The numbers do not play out nicely because some categories has to few count.
2) The intention was to show how subject of agreements diversify over time, however there are not so many changes from after 1945. This suggests that we can just collapse the last three into one. 

